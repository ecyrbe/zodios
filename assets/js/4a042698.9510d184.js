"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[557],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var o=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=o.createContext({}),u=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=u(e.components);return o.createElement(s.Provider,{value:t},e.children)},l={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),d=u(n),m=i,h=d["".concat(s,".").concat(m)]||d[m]||l[m]||a;return n?o.createElement(h,r(r({ref:t},c),{},{components:n})):o.createElement(h,r({ref:t},c))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,r=new Array(a);r[0]=d;var p={};for(var s in t)hasOwnProperty.call(t,s)&&(p[s]=t[s]);p.originalType=e,p.mdxType="string"==typeof e?e:i,r[1]=p;for(var u=2;u<a;u++)r[u]=n[u];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},9067:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>l,frontMatter:()=>a,metadata:()=>p,toc:()=>u});var o=n(7462),i=(n(7294),n(3905));const a={sidebar_position:3},r="OpenAPI",p={unversionedId:"api/openapi",id:"api/openapi",title:"OpenAPI",description:"Zodios API definition to OpenAPI",source:"@site/docs/api/openapi.md",sourceDirName:"api",slug:"/api/openapi",permalink:"/docs/api/openapi",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"API definition helpers",permalink:"/docs/api/helpers"},next:{title:"Typescript",permalink:"/docs/api/typescript"}},s={},u=[{value:"Zodios API definition to OpenAPI",id:"zodios-api-definition-to-openapi",level:2},{value:"Info option",id:"info-option",level:3},{value:"Servers option",id:"servers-option",level:3},{value:"Security scheme option",id:"security-scheme-option",level:3},{value:"Basic auth",id:"basic-auth",level:4},{value:"Bearer auth",id:"bearer-auth",level:4},{value:"OAuth2",id:"oauth2",level:4},{value:"custom tags",id:"custom-tags",level:3},{value:"Examples",id:"examples",level:3},{value:"swagger-ui-express",id:"swagger-ui-express",level:4},{value:"OpenAPI to Zodios API definition",id:"openapi-to-zodios-api-definition",level:2}],c={toc:u};function l(e){let{components:t,...a}=e;return(0,i.kt)("wrapper",(0,o.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"openapi"},"OpenAPI"),(0,i.kt)("h2",{id:"zodios-api-definition-to-openapi"},"Zodios API definition to OpenAPI"),(0,i.kt)("p",null,"Zodios api definition format while simple can contain sufficient information to generate an OpenAPI documentation."),(0,i.kt)("p",null,"To generate an OpenAPI documentation from your api definition, you can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"toOpenApi")," method of ",(0,i.kt)("inlineCode",{parentName:"p"},"@zodios/openapi")," package."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"function toOpenApi(\n  api: ZodiosApiDefinition,\n  options?: {\n    info?: OpenAPIV3.InfoObject\n    servers?: OpenAPIV3.ServerObject[];\n    securityScheme?: OpenAPIV3.SecuritySchemeObject;\n    tagsFromPathFn?: (path: string) => string[];\n  }\n): OpenAPIV3.Document;\n")),(0,i.kt)("h3",{id:"info-option"},"Info option"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"info")," option allows you to specify the OpenAPI info object."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'const doc = toOpenApi(api, {\n  info: {\n    title: "My API",\n    version: "1.0.0",\n  },\n});\n')),(0,i.kt)("h3",{id:"servers-option"},"Servers option"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"servers")," option allows you to specify the OpenAPI servers object. This is useful if you want to specify the base url of your api."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'const doc = toOpenApi(api, {\n  servers: [\n    {\n      url: "https://api.example.com",\n    },\n  ],\n});\n')),(0,i.kt)("h3",{id:"security-scheme-option"},"Security scheme option"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"securityScheme")," option allows you to specify the OpenAPI security scheme object. Zodios has 3 helper functions to generate the security scheme object."),(0,i.kt)("h4",{id:"basic-auth"},"Basic auth"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'import { basicAuthScheme } from "@zodios/openapi";\n\nconst doc = toOpenApi(api, {\n  securityScheme: basicAuthScheme(),\n});\n')),(0,i.kt)("h4",{id:"bearer-auth"},"Bearer auth"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'import { bearerAuthScheme } from "@zodios/openapi";\n\nconst doc = toOpenApi(api, {\n  securityScheme: bearerAuthScheme(),\n});\n')),(0,i.kt)("h4",{id:"oauth2"},"OAuth2"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'\nimport { oauth2Scheme } from "@zodios/openapi";\n\nconst doc = toOpenApi(api, {\n  securityScheme: oauth2Scheme({\n    implicit: {\n      authorizationUrl: "https://example.com/oauth2/authorize",\n      scopes: {\n        "read:users": "read users",\n        "write:users": "write users",\n      },\n    },\n  }),\n});\n')),(0,i.kt)("h3",{id:"custom-tags"},"custom tags"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"tagsFromPathFn")," option allows you to specify a function that returns an array of tags for a given path. This is useful if you want to group your endpoints by tags."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Zodios will by default deduce tags from the last named resource in the path. So for example, the path ",(0,i.kt)("inlineCode",{parentName:"p"},"/users/:id")," will have the tag ",(0,i.kt)("inlineCode",{parentName:"p"},"users"),", and the path ",(0,i.kt)("inlineCode",{parentName:"p"},"/users/:id/comments")," will have the tag ",(0,i.kt)("inlineCode",{parentName:"p"},"comments"),".\nOnly pass this option if you want to override this behavior.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"const doc = toOpenApi(api, {\n  // hardcoded tags with dictionary\n  tagsFromPathFn: (path) => {\n    '/users': ['users'],\n    '/users/:id': ['users'],\n    '/users/:id/comments': ['users'],\n  }[path],\n});\n")),(0,i.kt)("h3",{id:"examples"},"Examples"),(0,i.kt)("h4",{id:"swagger-ui-express"},"swagger-ui-express"),(0,i.kt)("p",null,"You can expose your OpenAPI documentation with the ",(0,i.kt)("inlineCode",{parentName:"p"},"@zodios/express")," package."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'import { serve, setup } from "swagger-ui-express";\nimport { makeApi } from "@zodios/core";\nimport { zodiosApp, zodiosRouter } from "@zodios/express";\nimport { toOpenApi } from "@zodios/openapi";\nimport { userApi } from "./api";\nimport { userRouter } from \'./userRouter\';\n\nconst app = zodiosApp();\n\n// expose user api endpoints\napp.use(\'/api/v1\', userRouter);\n\n// expose openapi documentation\nconst document = toOpenApi(userApi, {\n  info: {\n    title: "User API",\n    version: "1.0.0",\n    description: "A simple user API",\n  },\n  servers: [\n    {\n      url: "/api/v1", // base path of user api\n    },\n  ],\n});\n\napp.use(`/docs/swagger.json`, (_, res) => res.json(document));\napp.use("/docs", serve);\napp.use("/docs", setup(undefined, { swaggerUrl: "/docs/swagger.json" }));\n\napp.listen(3000);\n')),(0,i.kt)("p",null,"Result:",(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("img",{alt:"openapi",src:n(9466).Z,width:"615",height:"901"})),(0,i.kt)("h2",{id:"openapi-to-zodios-api-definition"},"OpenAPI to Zodios API definition"),(0,i.kt)("p",null,"If you want to use an existing OpenAPI documentation to generate your Zodios API definition, you can use the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/astahmer/openapi-zod-client"},"openapi-zod-client")," package."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'npx openapi-zod-client "swagger.json" -o "zodios-client.ts"\n')))}l.isMDXComponent=!0},9466:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/openapi-a85164c65a92ad6e28ebe2113f1c7534.png"}}]);